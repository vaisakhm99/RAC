(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     38272,        847]
NotebookOptionsPosition[     37253,        815]
NotebookOutlinePosition[     37588,        830]
CellTagsIndexPosition[     37545,        827]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MakeUnitVector", "[", "k_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", "k"], ",", 
     SubscriptBox["y", "k"], ",", 
     SubscriptBox["z", "k"]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AllParameters", "[", "n_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "i", "}"}], ",", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "i"], ",", 
          SubscriptBox["y", "i"], ",", 
          SubscriptBox["z", "i"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AllConstraints", "[", "n_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "i", "}"}], ",", 
     RowBox[{"And", "@@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox[
           SubscriptBox["x", "i"], "2"], "+", 
          SuperscriptBox[
           SubscriptBox["y", "i"], "2"], "+", 
          SuperscriptBox[
           SubscriptBox["z", "i"], "2"]}], "\[Equal]", "1"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Normalize", "[", "v_", "]"}], ":=", 
    RowBox[{"v", "/", 
     RowBox[{"Norm", "[", "v", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Factors", "=", 
    RowBox[{"{", 
     RowBox[{
     "1", ",", "2", ",", "3", ",", "12", ",", "13", ",", "23", ",", "123"}], 
     "}"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Factors", "=", 
    RowBox[{"Times", "@@@", 
     RowBox[{"Subsets", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"Tuples", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", "3"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "Rearrange", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Rearrange", " ", "the", " ", "numbers", " ", "in", " ", "the", " ", "RHS",
     " ", "to", " ", "obtain", " ", "different", " ", "combinations"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Factors", "[", 
    RowBox[{"[", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7"}], 
      "}"}], "]"}], "]"}], "=", 
   RowBox[{"Factors", "[", 
    RowBox[{"[", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7"}], 
      "}"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Factors", "=", 
    RowBox[{"Transpose", "[", "Factors", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8189131812168694`*^9, 3.818913412577162*^9}, {
   3.8189136020485573`*^9, 3.818913602528326*^9}, {3.818930316508902*^9, 
   3.818930316660079*^9}, {3.819002609301362*^9, 3.819002612676309*^9}, {
   3.819005388096765*^9, 3.819005391960493*^9}, {3.819009951322303*^9, 
   3.8190099521209393`*^9}, {3.819010653406536*^9, 3.819010653796645*^9}, {
   3.819010684028303*^9, 3.819010684388467*^9}, {3.8190107592142153`*^9, 
   3.819010759963049*^9}, {3.819011311538596*^9, 3.819011339463929*^9}, {
   3.819011416306404*^9, 3.819011416647843*^9}, {3.819011544054221*^9, 
   3.81901159209381*^9}, {3.819024819138592*^9, 3.819024819626935*^9}, {
   3.81902484965049*^9, 3.819024879273017*^9}, {3.819025253175044*^9, 
   3.819025260435253*^9}, 3.819025309708949*^9, {3.819025824825694*^9, 
   3.819025901632681*^9}, {3.819262121187537*^9, 3.819262121275382*^9}, {
   3.819262191326028*^9, 3.819262193922772*^9}, {3.819274865861936*^9, 
   3.819274876020529*^9}, {3.819276006782172*^9, 3.819276007359281*^9}, {
   3.819276051079975*^9, 3.8192760514243526`*^9}, {3.819277339339479*^9, 
   3.819277345080652*^9}, {3.8192774089483624`*^9, 3.819277409136746*^9}, {
   3.819277452706251*^9, 3.819277453120893*^9}, {3.8192776304408283`*^9, 
   3.819277630583888*^9}, {3.819277824046729*^9, 3.81927791051481*^9}, {
   3.819277983789825*^9, 3.819277986907505*^9}, {3.819278021304459*^9, 
   3.819278028689725*^9}, 3.819278065086595*^9, {3.819278159870399*^9, 
   3.8192781655161667`*^9}, {3.819278258589576*^9, 3.8192782614520063`*^9}, {
   3.819278307734057*^9, 3.819278309695437*^9}, {3.819278361356941*^9, 
   3.819278424506158*^9}, {3.819278505625902*^9, 3.819278536317459*^9}, {
   3.819278572461605*^9, 3.819278709879253*^9}, {3.819278952476344*^9, 
   3.819279088246694*^9}, {3.819283374595229*^9, 3.8192834120486937`*^9}, {
   3.819283464485133*^9, 3.819283481081842*^9}, {3.819283578796104*^9, 
   3.819283579571526*^9}, 3.819283742656878*^9, {3.819284622124157*^9, 
   3.819284623496716*^9}, {3.8192851820805883`*^9, 3.819285182904296*^9}, {
   3.819286737227903*^9, 3.81928673778508*^9}, 3.819341603010017*^9, {
   3.819368730815875*^9, 3.819368732437231*^9}, {3.819368912431241*^9, 
   3.8193689138114243`*^9}},ExpressionUUID->"f692bf65-d81d-46d1-a1fc-\
310edf36954c"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed","write",
   "\"Tag \\!\\(\\*RowBox[{\\\"Normalize\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"Normalize\\\", \\\"[\\\", \\\"v_\\\", \\\"]\\\"}]\\) is \
Protected.\"",2,4,1,17758237375337707460,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.818913458939739*^9, 3.818913546102708*^9, {3.81891359199514*^9, 
   3.818913626930788*^9}, {3.8189137058350067`*^9, 3.818913719786523*^9}, 
   3.818930333640215*^9, 3.81893053331971*^9, 3.818930715436768*^9, 
   3.818930747966202*^9, 3.8189308008976603`*^9, 3.818930836633258*^9, 
   3.81893094635826*^9, 3.818931085020658*^9, 3.818931208670826*^9, 
   3.818931266121274*^9, {3.818931497277162*^9, 3.818931514233383*^9}, 
   3.8189315463282967`*^9, 3.8189317148573627`*^9, 3.8190022648608828`*^9, 
   3.819002382879019*^9, {3.819002431409258*^9, 3.819002445553651*^9}, 
   3.819003193712412*^9, {3.81900324364445*^9, 3.819003264183313*^9}, 
   3.819003315343981*^9, 3.819003346562695*^9, {3.819003395409062*^9, 
   3.819003505435828*^9}, {3.8190035771887493`*^9, 3.819003592319726*^9}, 
   3.8190037199714108`*^9, 3.819003769132741*^9, 3.8190038848871937`*^9, {
   3.8190043245420847`*^9, 3.819004333184379*^9}, 3.819004391019318*^9, 
   3.819004424922038*^9, {3.819004609552238*^9, 3.819004634138298*^9}, {
   3.8190046663961*^9, 3.819004672368031*^9}, {3.819004724461876*^9, 
   3.819004766773769*^9}, {3.819004803619326*^9, 3.819004889251441*^9}, {
   3.819004937383108*^9, 3.819004948477013*^9}, 3.8190049984860687`*^9, {
   3.819005432938936*^9, 3.8190054945876713`*^9}, {3.819005532365719*^9, 
   3.819005599910735*^9}, 3.819005712334306*^9, {3.8190061106173286`*^9, 
   3.819006133212762*^9}, {3.819006218712689*^9, 3.819006261632278*^9}, 
   3.8190095130935917`*^9, {3.819009548213365*^9, 3.819009561388165*^9}, 
   3.819009659234255*^9, {3.819009700539962*^9, 3.8190097586686897`*^9}, 
   3.8190098631208363`*^9, 3.819009958709709*^9, 3.819010143793536*^9, 
   3.8190102840213842`*^9, 3.819010373211205*^9, 3.8190104763952017`*^9, 
   3.819010515268773*^9, 3.8190106191702547`*^9, 3.819010654552594*^9, 
   3.819010685325739*^9, 3.819010722002089*^9, 3.8190107614714403`*^9, 
   3.819010985039833*^9, {3.8190112949315987`*^9, 3.819011340215941*^9}, 
   3.819011418031015*^9, 3.81901145413524*^9, 3.8190118245846663`*^9, 
   3.819024720784504*^9, 3.8190247523382263`*^9, 3.819024786669827*^9, 
   3.819024821143141*^9, {3.819024851930367*^9, 3.8190248813217688`*^9}, 
   3.819024912186309*^9, 3.819025212229332*^9, {3.8190252551827097`*^9, 
   3.819025261202428*^9}, 3.81902531055945*^9, {3.819025816998065*^9, 
   3.8190259025727463`*^9}, {3.819025952048176*^9, 3.8190259748890953`*^9}, 
   3.819262134298931*^9, 3.8192621957507353`*^9, 3.819276009769363*^9, 
   3.819276052170759*^9, 3.819277166002817*^9, 3.8192773478269577`*^9, 
   3.819277411357723*^9, 3.819277454787112*^9, 3.819277641154635*^9, {
   3.819277827563774*^9, 3.819277852309227*^9}, {3.8192778828200073`*^9, 
   3.819277911693416*^9}, 3.81927794924807*^9, 3.819277988592661*^9, 
   3.8192780303666*^9, 3.819278067212592*^9, {3.819278109023847*^9, 
   3.819278131288096*^9}, 3.819278167759405*^9, 3.819278263274131*^9, 
   3.819278311345622*^9, {3.819278345531046*^9, 3.8192783950471373`*^9}, 
   3.819278425662125*^9, 3.8192784692035627`*^9, {3.81927850899312*^9, 
   3.819278651358295*^9}, {3.819278682990581*^9, 3.8192787107885017`*^9}, {
   3.819278940119116*^9, 3.819279089019417*^9}, 3.819282956577042*^9, {
   3.8192832371475782`*^9, 3.819283271372081*^9}, {3.819283355300851*^9, 
   3.819283413158998*^9}, {3.819283465876628*^9, 3.81928349896647*^9}, 
   3.8192835806575727`*^9, 3.819283743642789*^9, 3.819284637019223*^9, 
   3.819284681166724*^9, 3.819284717483515*^9, 3.819284750988112*^9, 
   3.819284782602631*^9, 3.8192849606519213`*^9, {3.819285195664139*^9, 
   3.819285216890854*^9}, {3.819285291613522*^9, 3.819285349656159*^9}, 
   3.819285471650297*^9, 3.819285508302004*^9, 3.819286740165595*^9, {
   3.819341610960781*^9, 3.8193416347518263`*^9}, {3.819341694040249*^9, 
   3.8193417094687567`*^9}, {3.8193417408318567`*^9, 3.819341821058074*^9}, {
   3.8193419167722263`*^9, 3.819341932295555*^9}, 3.819342449314178*^9, 
   3.819342511659807*^9, {3.819342575383699*^9, 3.8193426144962606`*^9}, 
   3.8193426756786137`*^9, 3.819342827251556*^9, 3.819343185995249*^9, {
   3.819347364052353*^9, 3.819347384555492*^9}, 3.819347500932939*^9, 
   3.819347680931499*^9, 3.819347883259059*^9, 3.8193479238476973`*^9, 
   3.819348841420403*^9, 3.819349355895996*^9, 3.819349592827752*^9, {
   3.81934976772012*^9, 3.8193497808062477`*^9}, 3.81935087031479*^9, 
   3.819356460351388*^9, {3.8193565034369173`*^9, 3.8193565229740763`*^9}, 
   3.81935660411799*^9, 3.819357427478998*^9, 3.819361116626214*^9, {
   3.819368765759574*^9, 3.819368767016173*^9}, 3.8193689167709837`*^9, 
   3.819431514460145*^9, 3.821274515736094*^9, 3.821274598543741*^9, 
   3.821275344024105*^9, 3.8214115556204987`*^9, 
   3.8214172226921673`*^9},ExpressionUUID->"29ffbf46-0d68-4443-8d2c-\
20b0d4db0c32"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FindConfiguration", "[", 
      RowBox[{"n_", ",", "q_", ",", 
       RowBox[{"opts___", "?", "OptionQ"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "vecs", ",", "bigsum", ",", "time", ",", "i", ",", "k", ",", "p", ",",
          "j", ",", "c", ",", "Nor", ",", "t", ",", "a", ",", "vecsx"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"Probability", "\[IndentingNewLine]", "q"}], "=", 
          RowBox[{"50", "/", "100"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"s", "=", 
         RowBox[{"1", "-", "q"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"r", "=", 
         RowBox[{
          RowBox[{"2", "*", "q"}], "-", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vecs", "=", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                SubscriptBox["v", "i"], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ".", 
              "#"}], "&"}], ",", 
            RowBox[{"Factors", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"1", ";;", "8"}], ",", 
               RowBox[{"1", ";;", "n"}]}], "]"}], "]"}]}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["v", "k_"], "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"MakeUnitVector", "[", "k", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"MakeUnitVector", "[", "k", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "*", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{"4", " ", "q", " ", "s"}]}], ")"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"MakeUnitVector", "[", "k", "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}], "*", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{"4", " ", "q", " ", "s"}]}], ")"}], "]"}]}]}], 
             "}"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vecsx", "=", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                SubscriptBox["v", "i"], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ".", 
              "#"}], "&"}], ",", 
            RowBox[{"Factors", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"1", ";;", "8"}], ",", 
               RowBox[{"1", ";;", "n"}]}], "]"}], "]"}]}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["v", "k_"], "\[Rule]", 
            RowBox[{"MakeUnitVector", "[", "k", "]"}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bigsum", "=", 
         RowBox[{"Plus", "@@", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sqrt", "[", 
              RowBox[{"#", ".", "#"}], "]"}], "&"}], ",", "vecs"}], "]"}]}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"time", ",", "res"}], "}"}], "=", 
         RowBox[{"Timing", "[", 
          RowBox[{"NMaximize", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"bigsum", ",", 
              RowBox[{"AllConstraints", "[", "n", "]"}]}], "}"}], ",", 
            RowBox[{"AllParameters", "[", "n", "]"}], ",", "opts", ",", 
            RowBox[{"MaxIterations", "\[Rule]", "500"}], ",", 
            RowBox[{"WorkingPrecision", "\[Rule]", "50"}], ",", 
            RowBox[{"AccuracyGoal", "\[Rule]", "Infinity"}], ",", 
            RowBox[{"PrecisionGoal", "\[Rule]", "Infinity"}]}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"p", "=", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox[
             RowBox[{
             "res", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             RowBox[{"n", "*", 
              SuperscriptBox["2", "3"]}]]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<n=\>\"", ",", "n", ",", "\"\< p=\>\"", ",", 
          RowBox[{"N", "[", 
           RowBox[{"p", ",", "10"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Nor", "=", 
         RowBox[{"Map", "[", 
          RowBox[{"Normalize", ",", 
           RowBox[{"vecsx", "/.", 
            RowBox[{
            "res", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}],
           "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"t", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"1", "-", 
              RowBox[{"4", "*", "s", "*", "q", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Nor", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "2"}], "]"}], "]"}], "^", "2"}], "+", 
                 RowBox[{
                  RowBox[{"Nor", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "3"}], "]"}], "]"}], "^", "2"}]}], 
                ")"}]}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "8"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"encod", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"t", "[", 
               RowBox[{"[", "c", "]"}], "]"}], "*", 
              RowBox[{"Nor", "[", 
               RowBox[{"[", 
                RowBox[{"c", ",", "1"}], "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"t", "[", 
               RowBox[{"[", "c", "]"}], "]"}], "*", 
              RowBox[{"Nor", "[", 
               RowBox[{"[", 
                RowBox[{"c", ",", "2"}], "]"}], "]"}], "*", 
              RowBox[{"r", "^", "2"}]}], ",", 
             RowBox[{
              RowBox[{"t", "[", 
               RowBox[{"[", "c", "]"}], "]"}], "*", 
              RowBox[{"Nor", "[", 
               RowBox[{"[", 
                RowBox[{"c", ",", "3"}], "]"}], "]"}], "*", 
              RowBox[{"r", "^", "2"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c", ",", "1", ",", "8"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"meas", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MakeUnitVector", "[", "i", "]"}], "/.", 
            RowBox[{"res", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Encoding=\>\"", ",", "encod", ",", "\"\<Measurements=\>\"", ",",
           "meas"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"bx", "=", "meas"}], ";", "\[IndentingNewLine]", 
        RowBox[{"ax", "=", "encod"}], ";", "\[IndentingNewLine]", 
        RowBox[{"sphereplot", "=", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Opacity", "[", "0.2", "]"}], ",", " ", 
             RowBox[{"Sphere", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "1"}], "]"}]}],
             "}"}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pointplot", "=", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", "[", "0.03", "]"}], ",", 
            RowBox[{"Point", "[", "ax", "]"}]}], "}"}], "]"}]}], ";", 
        RowBox[{"measureplot", "=", 
         RowBox[{"ListPointPlot3D", "[", 
          RowBox[{"bx", ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Red", ",", 
              RowBox[{"PointSize", "\[Rule]", ".01"}]}], "]"}]}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"arrowplot", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Blue", ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"bx", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}]}], "}"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "bx", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"origin", "=", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}]}], "}"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", 
         RowBox[{
         "sphereplot", ",", "arrowplot", ",", "pointplot", ",", "origin", ",", 
          RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
          RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8189134209407663`*^9, 3.8189134307744837`*^9}, {
   3.818913532588571*^9, 3.818913540119466*^9}, {3.818913582892386*^9, 
   3.818913591012331*^9}, 3.818913625763884*^9, 3.8189137188693247`*^9, {
   3.81893070232015*^9, 3.818930746903249*^9}, {3.818930784552124*^9, 
   3.8189307991112328`*^9}, {3.818930829471315*^9, 3.81893083435933*^9}, {
   3.818930936094866*^9, 3.818930941862941*^9}, {3.818931070167616*^9, 
   3.818931081629307*^9}, {3.818931115040114*^9, 3.818931196191235*^9}, 
   3.818931263942762*^9, {3.8189313133761797`*^9, 3.818931317288723*^9}, {
   3.818931348832651*^9, 3.818931353216283*^9}, {3.818931451488645*^9, 
   3.818931459448332*^9}, {3.818931502320711*^9, 3.8189315120885277`*^9}, 
   3.818931544952868*^9, {3.818931609985936*^9, 3.81893161198477*^9}, {
   3.8189317112805967`*^9, 3.818931712800185*^9}, {3.819002168822455*^9, 
   3.8190021749185333`*^9}, {3.8190023801089907`*^9, 
   3.8190023933439817`*^9}, {3.81900242607972*^9, 3.8190024439521303`*^9}, {
   3.819002477169012*^9, 3.819002483842629*^9}, {3.819002543220585*^9, 
   3.819002739038793*^9}, {3.8190028515671864`*^9, 3.819002894431149*^9}, {
   3.819002967366825*^9, 3.819003035662232*^9}, {3.819003072702252*^9, 
   3.819003190637661*^9}, {3.819003241644723*^9, 3.819003261990962*^9}, {
   3.819003310231348*^9, 3.819003502826874*^9}, {3.819003591336433*^9, 
   3.819003591555887*^9}, {3.81900364475692*^9, 3.819003647075354*^9}, {
   3.8190037176007843`*^9, 3.8190037182440863`*^9}, {3.819003760276401*^9, 
   3.819003767387412*^9}, {3.819003863670768*^9, 3.8190038834767303`*^9}, {
   3.819004071275628*^9, 3.819004072129265*^9}, 3.819004137390832*^9, {
   3.819004268325747*^9, 3.819004331854123*^9}, {3.819004388965353*^9, 
   3.819004389804434*^9}, {3.819004423348156*^9, 3.819004423722817*^9}, {
   3.819004466193825*^9, 3.819004631541231*^9}, {3.819004664268503*^9, 
   3.819004671476988*^9}, {3.819004707008615*^9, 3.819004947765493*^9}, 
   3.819005396080068*^9, {3.819005486046052*^9, 3.819005486394373*^9}, {
   3.819005530057019*^9, 3.819005612491519*^9}, {3.819005706190008*^9, 
   3.819005710981139*^9}, {3.819005972802156*^9, 3.819006132086545*^9}, {
   3.819006217201769*^9, 3.819006226408701*^9}, {3.8190062592057257`*^9, 
   3.819006260044155*^9}, {3.819006367665414*^9, 3.8190064041036863`*^9}, {
   3.8190095097644253`*^9, 3.8190095596203938`*^9}, 3.81900965640326*^9, {
   3.81900968981674*^9, 3.8190096915298347`*^9}, {3.8190097246171637`*^9, 
   3.819009755216076*^9}, {3.819009816112221*^9, 3.8190098247176123`*^9}, {
   3.8190098588148823`*^9, 3.819009861651126*^9}, {3.819010121570879*^9, 
   3.819010138817203*^9}, {3.819010215370315*^9, 3.819010281361788*^9}, {
   3.81901034472822*^9, 3.819010371515608*^9}, {3.819010437765891*^9, 
   3.8190105119804497`*^9}, {3.819010548756236*^9, 3.819010609744931*^9}, 
   3.819010643123139*^9, {3.8190107158181953`*^9, 3.8190107203938007`*^9}, {
   3.819011815498797*^9, 3.819011816223024*^9}, {3.8190246888493958`*^9, 
   3.819024718824912*^9}, {3.819024751562398*^9, 3.8190247824407187`*^9}, {
   3.819025443309009*^9, 3.819025450020482*^9}, 3.819025843006075*^9, 
   3.819262153206792*^9, {3.8192832604826813`*^9, 3.819283270347127*^9}, 
   3.819283769658976*^9, {3.8192854659143143`*^9, 3.8192854686611347`*^9}, {
   3.819285504131081*^9, 3.81928550693297*^9}, {3.819341604685049*^9, 
   3.819341630380468*^9}, {3.819341664104822*^9, 3.81934167629009*^9}, {
   3.819341739791559*^9, 3.819341776967082*^9}, {3.819348517497809*^9, 
   3.819348635762051*^9}, 3.819348669921612*^9, {3.819348850488613*^9, 
   3.819348851168666*^9}, {3.819356383290889*^9, 3.8193563919503508`*^9}, {
   3.8193564286065893`*^9, 3.819356459021061*^9}, {3.819356497370934*^9, 
   3.819356521661887*^9}, 3.819356602218719*^9, {3.819368754823813*^9, 
   3.819368755285581*^9}, 3.819372123602832*^9, {3.819372180410598*^9, 
   3.8193721821985283`*^9}, 3.8193722914219923`*^9, {3.819373350175377*^9, 
   3.819373352456971*^9}, {3.8193733908220587`*^9, 3.81937339267548*^9}, {
   3.819373434646339*^9, 3.8193734363701563`*^9}, 3.819373467591234*^9, {
   3.819374263512591*^9, 3.819374273297235*^9}, {3.821274536414288*^9, 
   3.821274537826765*^9}, {3.821274576077128*^9, 3.8212745920752296`*^9}, 
   3.821274627644011*^9, {3.821411530578307*^9, 3.821411546376011*^9}, {
   3.821417209759609*^9, 
   3.821417218275201*^9}},ExpressionUUID->"def73d64-d540-451d-8a51-\
124a598029ab"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FindConfiguration", "[", 
  RowBox[{"3", ",", 
   RowBox[{"95", "/", "100"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.819508390161088*^9, 3.819508395643252*^9}, {
  3.821274661206506*^9, 3.821274661477438*^9}, {3.821275324006155*^9, 
  3.821275341437207*^9}, {3.821275400224781*^9, 3.821275404814293*^9}, {
  3.82127544081773*^9, 3.8212754441422043`*^9}, {3.8212754756894283`*^9, 
  3.821275475805814*^9}, {3.821276782314892*^9, 3.821276783391432*^9}, {
  3.8212769133145037`*^9, 3.821276919079611*^9}, {3.821277171257513*^9, 
  3.821277171407856*^9}, {3.821411573169733*^9, 
  3.8214115991186438`*^9}},ExpressionUUID->"e6363462-ff69-46bc-b6b8-\
d3f8f0941189"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"n=\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\" p=\"\>", "\[InvisibleSpace]", 
   "0.77060200743632968949311040030862710852`10."}],
  SequenceForm["n=", 3, " p=", 0.77060200743632968949311040030862710852`10.],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8212753610409527`*^9, {3.821275433321806*^9, 3.821275462800623*^9}, 
   3.821275495132491*^9, 3.821276803631297*^9, 3.821276924172988*^9, 
   3.821277176111059*^9, {3.82141156649358*^9, 3.8214116054664183`*^9}, 
   3.82141723089161*^9},ExpressionUUID->"1e5d9324-6aa1-48ee-bccb-\
a1f9a30773a3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Encoding=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.`27.354396676983114"}], ",", 
       RowBox[{
       "-", "1.183340287059247094017615029993708780809509558969377822`27.\
354396676983114*^-23"}], ",", 
       RowBox[{
       "-", "1.385928145923081327273771370840212803739174412922027973`27.\
354396676983114*^-23"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "-", "0.446428571428571428571420934284004835829699587921605516134873698\
53892140378644`47.908206456622764"}], ",", 
       "0.00673818436298050948368295012541986976178617057979517495577172072394\
648301431`47.908206456622764", ",", 
       RowBox[{
       "-", "0.805309155956523849761537835704459270185863343307804341902852019\
65535880162859`47.908206456622764"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "-", "0.446428571428571428571433544294855773937775085806860914304723654\
3150614061342`49.44812852220842"}], ",", 
       RowBox[{
       "-", "0.700787279140044296735663321750897427419315788604711686001902140\
17255087405525`49.44812852220842"}], ",", 
       "0.39681913914453773865065950498421848693754619345168245998580687854910\
991014305`49.44812852220842"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.446428571428571428571459192328392433593407668687510463432579658701614\
96037761`49.44812852220842", ",", 
       RowBox[{
       "-", "0.694049094777063787251960936821622275378431474877278626367297989\
52936038778313`49.44812852220842"}], ",", 
       RowBox[{
       "-", "0.408490016811986111110855864949516624450664311257868117793418191\
31639716944215`49.44812852220842"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "-", "0.446428571428571428571459192328392433593407668687510463432579658\
70161496037761`49.44812852220842"}], ",", 
       "0.69404909477706378725196093682162227537843147487727862636729798952936\
038778313`49.44812852220842", ",", 
       "0.40849001681198611111085586494951662445066431125786811779341819131639\
716944215`49.44812852220842"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.446428571428571428571433544294855773937775085806860914304723654315061\
4061342`49.44812852220842", ",", 
       "0.70078727914004429673566332175089742741931578860471168600190214017255\
087405525`49.44812852220842", ",", 
       RowBox[{
       "-", "0.396819139144537738650659504984218486937546193451682459985806878\
54910991014305`49.44812852220842"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.446428571428571428571420934284004835829699587921605516134873698538921\
40378644`47.908206456622764", ",", 
       RowBox[{
       "-", "0.006738184362980509483682950125419869761786170579795174955771720\
72394648301431`47.908206456622764"}], ",", 
       "0.80530915595652384976153783570445927018586334330780434190285201965535\
880162859`47.908206456622764"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1.`27.354396676983114", ",", 
       "1.183340287059247094017615029993708780809509558969377822`27.\
354396676983114*^-23", ",", 
       "1.385928145923081327273771370840212803739174412922027973`27.\
354396676983114*^-23"}], "}"}]}], "}"}], 
   "\[InvisibleSpace]", "\<\"Measurements=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "-", "0.668153104781060961711376003549974203641983670085127738148267584\
82933297235711`50."}], ",", 
       RowBox[{
       "-", "0.641208375865769891614664951556807279753768306756727971647212685\
94308783202764`50."}], ",", 
       RowBox[{
       "-", "0.377390046624192428537287378287516671227622584947842585089853615\
06712304915829`50."}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "-", "0.668153104781060961711396930307679326462941330764682931716579282\
28444306370336`50."}], ",", 
       "0.64743355544482932075684018600078831623140301803378526081025610485267\
822559165`50.", ",", 
       RowBox[{
       "-", "0.366607719307021260679928432439332348290050840888977090266463958\
26198446681351`50."}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "-", "0.668153104781060961711407107093023447682618790010542745067949718\
04127709139968`50."}], ",", 
       RowBox[{
       "-", "0.006225179579059429142204517869418486399131495762967984297847743\
39509652897749`50."}], ",", 
       "0.74399776593121368921718151397893413188417046359996109128872886229524\
302754037`50."}], "}"}]}], "}"}]}],
  SequenceForm[
  "Encoding=", {{-1.`27.354396676983114, \
-1.183340287059247094017615029993708780809509558969377822`27.354396676983114*^\
-23, -1.385928145923081327273771370840212803739174412922027973`27.\
354396676983114*^-23}, \
{-0.44642857142857142857142093428400483582969958792160551613487369853892140378\
644`47.908206456622764, 
     0.00673818436298050948368295012541986976178617057979517495577172072394648\
301431`47.908206456622764, \
-0.805309155956523849761537835704459270185863343307804341902852019655358801628\
59`47.908206456622764}, \
{-0.44642857142857142857143354429485577393777508580686091430472365431506140613\
42`49.44812852220842, \
-0.700787279140044296735663321750897427419315788604711686001902140172550874055\
25`49.44812852220842, 
     0.39681913914453773865065950498421848693754619345168245998580687854910991\
014305`49.44812852220842}, {
    0.446428571428571428571459192328392433593407668687510463432579658701614960\
37761`49.44812852220842, \
-0.694049094777063787251960936821622275378431474877278626367297989529360387783\
13`49.44812852220842, \
-0.408490016811986111110855864949516624450664311257868117793418191316397169442\
15`49.44812852220842}, \
{-0.44642857142857142857145919232839243359340766868751046343257965870161496037\
761`49.44812852220842, 
     0.69404909477706378725196093682162227537843147487727862636729798952936038\
778313`49.44812852220842, 
     0.40849001681198611111085586494951662445066431125786811779341819131639716\
944215`49.44812852220842}, {
    0.446428571428571428571433544294855773937775085806860914304723654315061406\
1342`49.44812852220842, 
     0.70078727914004429673566332175089742741931578860471168600190214017255087\
405525`49.44812852220842, \
-0.396819139144537738650659504984218486937546193451682459985806878549109910143\
05`49.44812852220842}, {
    0.446428571428571428571420934284004835829699587921605516134873698538921403\
78644`47.908206456622764, \
-0.006738184362980509483682950125419869761786170579795174955771720723946483014\
31`47.908206456622764, 
     0.80530915595652384976153783570445927018586334330780434190285201965535880\
162859`47.908206456622764}, {
    1.`27.354396676983114, 
     1.183340287059247094017615029993708780809509558969377822`27.\
354396676983114*^-23, 
     1.385928145923081327273771370840212803739174412922027973`27.\
354396676983114*^-23}}, 
   "Measurements=", \
{{-0.6681531047810609617113760035499742036419836700851277381482675848293329723\
5711`50., \
-0.641208375865769891614664951556807279753768306756727971647212685943087832027\
64`50., -0.\
37739004662419242853728737828751667122762258494784258508985361506712304915829`\
50.}, {-0.\
66815310478106096171139693030767932646294133076468293171657928228444306370336`\
50., 0.64743355544482932075684018600078831623140301803378526081025610485267822\
559165`50., \
-0.366607719307021260679928432439332348290050840888977090266463958261984466813\
51`50.}, {-0.\
66815310478106096171140710709302344768261879001054274506794971804127709139968`\
50., -0.0062251795790594291422045178694184863991314957629679842978477433950965\
2897749`50., 
     0.74399776593121368921718151397893413188417046359996109128872886229524302\
754037`50.}}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8212753610409527`*^9, {3.821275433321806*^9, 3.821275462800623*^9}, 
   3.821275495132491*^9, 3.821276803631297*^9, 3.821276924172988*^9, 
   3.821277176111059*^9, {3.82141156649358*^9, 3.8214116054664183`*^9}, 
   3.8214172308929377`*^9},ExpressionUUID->"2394032f-1e3f-4299-a14a-\
58b6a8c58efe"]
}, Open  ]],

Cell[BoxData[
 Graphics3DBox[{
   {Opacity[0.2], SphereBox[{0, 0, 0}, 1]}, 
   {RGBColor[0, 0, 1], Thickness[Large], 
    Arrow3DBox[{{0, 0, 
      0}, {-0.6681531047810609, -0.6412083758657698, \
-0.37739004662419245`}}]}, 
   {RGBColor[0, 0, 1], Thickness[Large], 
    Arrow3DBox[{{0, 0, 0}, {-0.6681531047810609, 
      0.6474335554448293, -0.36660771930702124`}}]}, 
   {RGBColor[0, 0, 1], Thickness[Large], 
    Arrow3DBox[{{0, 0, 0}, {-0.6681531047810609, -0.006225179579059429, 
      0.7439977659312137}}]}, 
   {PointSize[0.03], 
    Point3DBox[{{-1., -1.183340287059247*^-23, -1.3859281459230813`*^-23}, \
{-0.44642857142857145`, 
     0.00673818436298051, -0.8053091559565239}, {-0.44642857142857145`, \
-0.7007872791400444, 0.39681913914453776`}, {
     0.44642857142857145`, -0.6940490947770638, -0.4084900168119861}, \
{-0.44642857142857145`, 0.6940490947770638, 0.4084900168119861}, {
     0.44642857142857145`, 0.7007872791400444, -0.39681913914453776`}, {
     0.44642857142857145`, -0.00673818436298051, 0.8053091559565239}, {1., 
     1.183340287059247*^-23, 1.3859281459230813`*^-23}}]}, 
   {PointSize[0.02], Point3DBox[{0, 0, 0}]}},
  Axes->False,
  Boxed->False,
  ImageSize->{340.6228796302279, 399.5085013725864},
  ViewPoint->{-2.9007562472410124`, -0.08362459530380767, \
-1.7402931135738342`},
  ViewVertical->{-0.24362764398855336`, 
   0.5878715250340553, -0.7713965524545212}]], "Output",
 CellChangeTimes->{
  3.819508407450491*^9, 3.8212745310928793`*^9, {3.821274621445258*^9, 
   3.821274642441074*^9}, 3.821274677041933*^9, {3.821275338197466*^9, 
   3.821275361111936*^9}, {3.821275433346187*^9, 3.821275462826042*^9}, 
   3.8212754951557617`*^9, 3.821276803658772*^9, 3.8212769241984243`*^9, 
   3.82127717613586*^9, {3.821411566562727*^9, 3.821411605493327*^9}, 
   3.821417230959475*^9},ExpressionUUID->"9e5e3325-bc54-4223-9672-\
4023b4bca997"]
}, Open  ]]
},
WindowSize->{956, 1041},
WindowMargins->{{2, Automatic}, {Automatic, 18}},
FrontEndVersion->"11.1 for Linux x86 (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 5461, 131, 357, "Input", "ExpressionUUID" -> \
"f692bf65-d81d-46d1-a1fc-310edf36954c"],
Cell[6044, 155, 5078, 74, 23, "Message", "ExpressionUUID" -> \
"29ffbf46-0d68-4443-8d2c-20b0d4db0c32"]
}, Open  ]],
Cell[11137, 232, 14691, 324, 646, "Input", "ExpressionUUID" -> \
"def73d64-d540-451d-8a51-124a598029ab"],
Cell[CellGroupData[{
Cell[25853, 560, 685, 12, 34, "Input", "ExpressionUUID" -> \
"e6363462-ff69-46bc-b6b8-d3f8f0941189"],
Cell[CellGroupData[{
Cell[26563, 576, 624, 12, 24, "Print", "ExpressionUUID" -> \
"1e5d9324-6aa1-48ee-bccb-a1f9a30773a3"],
Cell[27190, 590, 8148, 181, 259, "Print", "ExpressionUUID" -> \
"2394032f-1e3f-4299-a14a-58b6a8c58efe"]
}, Open  ]],
Cell[35353, 774, 1884, 38, 448, "Output", "ExpressionUUID" -> \
"9e5e3325-bc54-4223-9672-4023b4bca997"]
}, Open  ]]
}
]
*)

