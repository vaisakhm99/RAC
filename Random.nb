(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     10494,        267]
NotebookOptionsPosition[      9856,        245]
NotebookOutlinePosition[     10191,        260]
CellTagsIndexPosition[     10148,        257]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"p", "=", 
   RowBox[{"65", "/", "100"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dist", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Binomial", "[", 
        RowBox[{"x", ",", "i"}], "]"}], "*", 
       RowBox[{"Binomial", "[", 
        RowBox[{"y", ",", "j"}], "]"}], "*", 
       RowBox[{"Binomial", "[", 
        RowBox[{"z", ",", "k"}], "]"}], "*", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", "-", 
            RowBox[{"2", "*", "i"}]}], ")"}], "^", "2"}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"y", "-", 
             RowBox[{"2", "*", "j"}]}], ")"}], "^", "2"}], "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "*", "p"}], "-", "1"}], ")"}], "^", "2"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"z", "-", 
             RowBox[{"2", "*", "k"}]}], ")"}], "^", "2"}], "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "*", "p"}], "-", "1"}], ")"}], "^", "2"}]}]}], 
        "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "x", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "0", ",", "y", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "z", ",", "1"}], "}"}]}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", "^", 
      RowBox[{"(", 
       RowBox[{"x", "+", "y", "+", "z"}], ")"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prob", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"dist", "/", 
       RowBox[{"(", 
        RowBox[{"x", "+", "y", "+", "z"}], ")"}]}]}], ")"}], "/", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"prob", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "+", "y", "+", "z"}], "\[Equal]", "7"}], "&&", 
      RowBox[{"Element", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Integers"}], 
       "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.819273686441839*^9, 3.819273977477521*^9}, {
   3.819274007989533*^9, 3.819274150499523*^9}, {3.8192741812383547`*^9, 
   3.819274183094221*^9}, {3.819274260162431*^9, 3.819274497191841*^9}, {
   3.8192745327954206`*^9, 3.819274535370777*^9}, {3.819274576400969*^9, 
   3.819274579950102*^9}, {3.819276041872314*^9, 3.819276042224153*^9}, {
   3.8192760740237427`*^9, 3.8192760853205767`*^9}, {3.819276170171287*^9, 
   3.819276230529562*^9}, {3.819276344615727*^9, 3.819276347294903*^9}, {
   3.819276574098419*^9, 3.8192765944180593`*^9}, {3.8192766470110188`*^9, 
   3.819276665297955*^9}, {3.819276724122406*^9, 3.819276825506769*^9}, {
   3.819276871540888*^9, 3.819276892523159*^9}, {3.819276967409916*^9, 
   3.819277022784984*^9}, {3.819277095552953*^9, 3.819277111417101*^9}, {
   3.819277152419065*^9, 3.8192771528633623`*^9}, {3.819277240520966*^9, 
   3.819277244401248*^9}, {3.8192774742035837`*^9, 3.819277474649485*^9}, {
   3.819277623907783*^9, 3.819277625906328*^9}, 3.819283657984129*^9, 
   3.81928371903471*^9, {3.8192837905767927`*^9, 3.819283908014412*^9}, {
   3.819283957578861*^9, 3.819283958056635*^9}, {3.819284098347727*^9, 
   3.819284149378626*^9}, {3.819284419428714*^9, 3.81928446515239*^9}, 
   3.8192845014744587`*^9, {3.819284626971467*^9, 3.819284703293591*^9}, {
   3.8192847366770277`*^9, 3.819284737172421*^9}, {3.81928477406082*^9, 
   3.8192847745872726`*^9}, {3.8192849388783207`*^9, 3.819284939526239*^9}, {
   3.819285171829028*^9, 3.819285176706356*^9}, {3.819285208083112*^9, 
   3.819285208553879*^9}, {3.819285295599234*^9, 3.819285323510388*^9}, {
   3.819285353838767*^9, 3.819285354918298*^9}, {3.8192853915769*^9, 
   3.819285441093485*^9}, 3.819285614353489*^9, {3.819286743544619*^9, 
   3.819286744032236*^9}},ExpressionUUID->"886258da-0a3c-45da-b8d2-\
8a827cc4391b"],

Cell[BoxData[
 TemplateBox[{
  "NMaximize","cvmit",
   "\"Failed to converge to the requested accuracy or precision within \\!\\(\
\\*RowBox[{\\\"100\\\"}]\\) iterations.\"",2,22,3,17744271469273475444,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.819285423405217*^9, 3.8192854419456577`*^9}, 
   3.819285620957502*^9, 3.81928566437376*^9, {3.819286159206558*^9, 
   3.819286185023039*^9}, 
   3.819286763386798*^9},ExpressionUUID->"a13ca9ed-3c82-4971-bef8-\
dd5a9f5101e5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.65625`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", "7"}], ",", 
     RowBox[{"y", "\[Rule]", "0"}], ",", 
     RowBox[{"z", "\[Rule]", "0"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8192739713134117`*^9, 3.8192739785462027`*^9}, 
   3.8192741847512207`*^9, {3.819274262934462*^9, 3.8192743808773623`*^9}, {
   3.819274425478051*^9, 3.819274498604456*^9}, 3.819274536270022*^9, 
   3.819274581376397*^9, 3.819276043316703*^9, {3.819276079541966*^9, 
   3.819276086167431*^9}, {3.8192761711263723`*^9, 3.819276231413926*^9}, 
   3.8192763483307467`*^9, 3.819276576750155*^9, 3.819276766045526*^9, {
   3.8192767986882353`*^9, 3.819276826688456*^9}, {3.81927687787138*^9, 
   3.8192768973043833`*^9}, {3.819276954690818*^9, 3.8192769683537292`*^9}, 
   3.8192770003032427`*^9, 3.819277116367803*^9, 3.819277260766541*^9, 
   3.819277475902664*^9, 3.819277626728368*^9, 3.819283658974345*^9, 
   3.819283720027746*^9, {3.819283795725603*^9, 3.819283909672266*^9}, 
   3.819283959118267*^9, {3.819284030898241*^9, 3.819284062624258*^9}, {
   3.8192841004676323`*^9, 3.819284106267338*^9}, {3.8192841521017036`*^9, 
   3.819284178579011*^9}, 3.819284393347719*^9, {3.819284429189495*^9, 
   3.819284466808605*^9}, 3.819284505790634*^9, {3.819284664124593*^9, 
   3.819284712266789*^9}, 3.81928474391365*^9, {3.819284782554957*^9, 
   3.819284803880433*^9}, 3.819284960532393*^9, {3.819285193303754*^9, 
   3.819285216844298*^9}, 3.8192853096078453`*^9, 3.819285340903392*^9, {
   3.819285381554916*^9, 3.819285441953251*^9}, 3.819285620963706*^9, 
   3.819285664379765*^9, {3.819286159212277*^9, 3.819286185032113*^9}, 
   3.819286763392672*^9},ExpressionUUID->"3ef93165-4c26-4bb8-9b15-\
57c53660f4dd"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"x", "=", "7"}], ";", "\[IndentingNewLine]", 
   RowBox[{"y", "=", "0"}], ";", "\[IndentingNewLine]", 
   RowBox[{"z", "=", "0"}], ";", "\[IndentingNewLine]", 
   RowBox[{"n", "=", 
    RowBox[{"x", "+", "y", "+", "z"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"p", "=", 
    RowBox[{"95", "/", "100"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"dist", "=", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Binomial", "[", 
         RowBox[{"x", ",", "i"}], "]"}], "*", 
        RowBox[{"Binomial", "[", 
         RowBox[{"y", ",", "j"}], "]"}], "*", 
        RowBox[{"Binomial", "[", 
         RowBox[{"z", ",", "k"}], "]"}], "*", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x", "-", 
             RowBox[{"2", "*", "i"}]}], ")"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"y", "-", 
              RowBox[{"2", "*", "j"}]}], ")"}], "^", "2"}], "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "*", "p"}], "-", "1"}], ")"}], "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"z", "-", 
              RowBox[{"2", "*", "k"}]}], ")"}], "^", "2"}], "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "*", "p"}], "-", "1"}], ")"}], "^", "2"}]}]}], 
         "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "x", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "y", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "z", ",", "1"}], "}"}]}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"2", "^", 
       RowBox[{"(", 
        RowBox[{"x", "+", "y", "+", "z"}], ")"}]}], ")"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"prob", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"dist", "/", 
        RowBox[{"(", 
         RowBox[{"x", "+", "y", "+", "z"}], ")"}]}]}], ")"}], "/", "2"}]}], 
   ";", "\[IndentingNewLine]", 
   RowBox[{"N", "[", "prob", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.8192840145125628`*^9, 3.819284040495534*^9}, {
  3.8192841337636127`*^9, 3.819284134089466*^9}, {3.819284369862763*^9, 
  3.819284373756055*^9}, {3.819284790258004*^9, 3.8192848117051497`*^9}, {
  3.819284843539957*^9, 3.81928484381713*^9}, {3.819284880467538*^9, 
  3.819284907102982*^9}, {3.8192856535697527`*^9, 3.8192857094207077`*^9}, {
  3.819286149605431*^9, 
  3.819286157626869*^9}},ExpressionUUID->"71f78834-0dd1-469d-8d7f-\
023dcb19a6f4"]
},
WindowSize->{636, 1041},
WindowMargins->{{2, Automatic}, {Automatic, 18}},
FrontEndVersion->"11.1 for Linux x86 (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 4221, 101, 125, "Input", "ExpressionUUID" -> \
"886258da-0a3c-45da-b8d2-8a827cc4391b"],
Cell[4804, 125, 504, 11, 23, "Message", "ExpressionUUID" -> \
"a13ca9ed-3c82-4971-bef8-dd5a9f5101e5"],
Cell[5311, 138, 1772, 29, 34, "Output", "ExpressionUUID" -> \
"3ef93165-4c26-4bb8-9b15-57c53660f4dd"]
}, Open  ]],
Cell[7098, 170, 2754, 73, 227, "Input", "ExpressionUUID" -> \
"71f78834-0dd1-469d-8d7f-023dcb19a6f4"]
}
]
*)

